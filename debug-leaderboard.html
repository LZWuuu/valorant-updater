<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>调试 Leaderboard 数据</title>
</head>
<body>
  <h1>调试 Leaderboard 数据</h1>
  <button onclick="checkData()">检查数据</button>
  <pre id="log"></pre>

  <script type="module">
    import { loadConfig } from './js/config.js';
    import { loadLeaderboardData } from './js/api/github.js';

    window.checkData = async function() {
      const log = document.getElementById('log');
      log.textContent = '开始检查...\n';

      try {
        // 加载配置
        await loadConfig();
        log.textContent += '✅ 配置加载完成\n';

        // 从GitHub加载leaderboard数据
        const leaderboardData = await loadLeaderboardData();

        if (leaderboardData && leaderboardData.players) {
          log.textContent += `\n📊 Leaderboard 数据 (${leaderboardData.players.length} 个玩家):\n\n`;

          leaderboardData.players.forEach((player, index) => {
            log.textContent += `玩家 ${index + 1} (${player.puuid.substring(0, 8)}...):\n`;
            log.textContent += `  - kills: ${player.kills}\n`;
            log.textContent += `  - deaths: ${player.deaths}\n`;
            log.textContent += `  - assists: ${player.assists}\n`;
            log.textContent += `  - headshots: ${player.headshots}\n`;
            log.textContent += `  - bodyshots: ${player.bodyshots}\n`;
            log.textContent += `  - legshots: ${player.legshots}\n`;
            log.textContent += `  - headrate: ${player.headrate}\n`;
            log.textContent += `  - win: ${player.win}\n`;
            log.textContent += `  - all: ${player.all}\n`;
            log.textContent += `  - 计算的爆头率: ${
              (player.headshots + player.bodyshots + player.legshots) > 0
                ? ((player.headshots / (player.headshots + player.bodyshots + player.legshots)) * 100).toFixed(1)
                : '0'
            }%\n`;
            log.textContent += '\n';
          });

          // 显示原始JSON的一部分
          log.textContent += '\n原始JSON (第一个玩家):\n';
          log.textContent += JSON.stringify(leaderboardData.players[0], null, 2);
        } else {
          log.textContent += '❌ 无法加载 leaderboard 数据\n';
        }

      } catch (error) {
        log.textContent += `❌ 错误: ${error.message}\n`;
        console.error('详细错误:', error);
      }
    }
  </script>
</body>
</html>